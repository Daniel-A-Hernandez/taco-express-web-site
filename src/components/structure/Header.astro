---
import { Image } from 'astro:assets';
import logo from '@/assets/logo-tacoexpress.png';
import Navbar from '@/components/structure/Navbar.tsx';
---

<header class="sticky top-0 z-40 bg-white shadow-md border-b border-orange-100">
  <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center">

    <!-- Logo y Nombre -->
    <div class="flex items-center space-x-3">
      <Image
        src={logo}
        alt="Logo taco express"
        class="w-15 h-15 object-contain"
        priority
      />

      <div>
        <h1 class="text-xl font-bold text-orange-900 leading-none">
          Taco Express
        </h1>

        <!-- Estado del restaurante -->
        <div class="flex items-center text-[10px] font-bold uppercase tracking-widest mt-0.5">
          <span
            id="indicador-dot"
            class="w-3 h-3 mr-2 rounded-full bg-gray-400"
          ></span>
          <span id="indicador-text">Cargandoâ€¦</span>
        </div>
      </div>
    </div>

    <Navbar client:only="preact" />
  </div>
</header>

<script>
  function actualizarEstado() {
    const now = new Date();

    const hours = now.getHours();
    const day = new Intl.DateTimeFormat('es-ES', {
      weekday: 'long',
      timeZone: 'America/El_Salvador'
    }).format(now);

    const dot = document.getElementById('indicador-dot');
    const text = document.getElementById('indicador-text');

    if (!dot || !text) return;

    const cerrado =
      day === 'lunes' ||
      hours < 14 ||
      hours >= 22;

    if (cerrado) {
      dot.className =
        'w-3 h-3 mr-2 rounded-full bg-red-500 animate-pulse';
      text.textContent = 'Cerrado';
    } else {
      dot.className =
        'w-3 h-3 mr-2 rounded-full bg-green-500 animate-pulse';
      text.textContent = 'Abierto ahora';
    }
  }

  actualizarEstado();
</script>
